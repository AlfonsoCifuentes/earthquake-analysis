{
    "cells": [
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "# üåç An√°lisis de Terremotos: Estudio de Datos S√≠smicos del USGS\n",
                "\n",
                "![Imagen de terremoto](https://images.unsplash.com/photo-1635147980241-97800f60fed6?q=80&w=1000)\n",
                "\n",
                "## üìã √çndice\n",
                "1. [Introducci√≥n](#introducci√≥n)\n",
                "2. [Fuentes de Datos](#fuentes-de-datos)\n",
                "3. [Fase de Preprocesamiento](#fase-de-preprocesamiento)\n",
                "   - [Carga de datos](#carga-de-datos)\n",
                "   - [Limpieza y transformaciones](#limpieza-y-transformaciones)\n",
                "   - [Preparaci√≥n para an√°lisis](#preparaci√≥n-para-an√°lisis)\n",
                "4. [An√°lisis Exploratorio de Datos (EDA)](#an√°lisis-exploratorio-de-datos-eda)\n",
                "   - [Distribuci√≥n temporal](#distribuci√≥n-temporal)\n",
                "   - [An√°lisis geoespacial](#an√°lisis-geoespacial)\n",
                "   - [Categorizaci√≥n por magnitud](#categorizaci√≥n-por-magnitud)\n",
                "5. [Conclusiones](#conclusiones)\n",
                "6. [Referencias](#referencias)"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## üìù Introducci√≥n\n",
                "\n",
                "El Servicio Geol√≥gico de Estados Unidos (USGS) mantiene uno de los repositorios m√°s completos de datos s√≠smicos a nivel mundial. Este informe presenta un an√°lisis detallado de estos datos, con el objetivo de identificar patrones s√≠smicos, zonas de alta actividad y tendencias temporales que puedan contribuir a nuestra comprensi√≥n de estos fen√≥menos naturales.\n",
                "\n",
                "Los terremotos representan uno de los fen√≥menos geol√≥gicos m√°s impactantes y potencialmente devastadores. El estudio de sus caracter√≠sticas, frecuencia y distribuci√≥n geogr√°fica es fundamental para la evaluaci√≥n de riesgos y la implementaci√≥n de medidas preventivas."
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## üóÉÔ∏è Fuentes de Datos\n",
                "\n",
                "Este an√°lisis se basa en datos obtenidos de tres fuentes principales:\n",
                "\n",
                "1. **ComCat (Comprehensive Catalog)**: Base de datos unificada de terremotos que integra m√∫ltiples cat√°logos. Accesible a trav√©s de [earthquake.usgs.gov/data/comcat/](https://earthquake.usgs.gov/data/comcat/)\n",
                "\n",
                "2. **USGS Earthquake Feed**: Sistema de distribuci√≥n de informaci√≥n en tiempo real sobre actividad s√≠smica. Disponible en [earthquake.usgs.gov/earthquakes/feed/](https://earthquake.usgs.gov/earthquakes/feed/)\n",
                "\n",
                "3. **Dataset local**: Colecci√≥n de datos previamente descargados para este an√°lisis.\n",
                "\n",
                "> *Nota: Todos los datos utilizados son de dominio p√∫blico seg√∫n la pol√≠tica del USGS: [usgs.gov/information-policies-and-instructions/copyrights-and-credits](https://www.usgs.gov/information-policies-and-instructions/copyrights-and-credits)*"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## üîç Fase de Preprocesamiento\n",
                "\n",
                "### Carga de datos\n",
                "\n",
                "Comenzamos importando las bibliotecas necesarias y cargando los datasets:"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "# Importamos las bibliotecas necesarias\n",
                "import pandas as pd\n",
                "import numpy as np\n",
                "import matplotlib.pyplot as plt\n",
                "import seaborn as sns\n",
                "import folium\n",
                "import geopandas as gpd\n",
                "from datetime import datetime\n",
                "import plotly.express as px\n",
                "from plotly.subplots import make_subplots\n",
                "import plotly.graph_objects as go\n",
                "\n",
                "# Configuraci√≥n visual\n",
                "plt.style.use('seaborn-v0_8-whitegrid')\n",
                "sns.set_palette(\"viridis\")"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "# Carga del dataset de terremotos\n",
                "earthquakes_df = pd.read_csv('all_month.csv')\n",
                "\n",
                "# Mostramos las primeras filas para inspeccionar la estructura\n",
                "print(f\"Dimensiones del dataset: {earthquakes_df.shape}\")\n",
                "earthquakes_df.head()"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "### Limpieza y transformaciones\n",
                "\n",
                "Ahora procedemos a limpiar y transformar los datos para su an√°lisis:"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "# Verificamos valores faltantes\n",
                "missing_values = earthquakes_df.isnull().sum()\n",
                "print(\"Valores faltantes por columna:\")\n",
                "print(missing_values[missing_values > 0])\n",
                "\n",
                "# Convertimos la columna de tiempo a formato datetime\n",
                "earthquakes_df['time'] = pd.to_datetime(earthquakes_df['time'])\n",
                "\n",
                "# Extraemos componentes de fecha para an√°lisis temporales\n",
                "earthquakes_df['year'] = earthquakes_df['time'].dt.year\n",
                "earthquakes_df['month'] = earthquakes_df['time'].dt.month\n",
                "earthquakes_df['day'] = earthquakes_df['time'].dt.day\n",
                "earthquakes_df['hour'] = earthquakes_df['time'].dt.hour\n",
                "\n",
                "# Creamos categor√≠as de magnitud para facilitar el an√°lisis\n",
                "magnitude_bins = [0, 2.5, 4.0, 5.5, 7.0, 10.0]\n",
                "magnitude_labels = ['Micro (<2.5)', 'Leve (2.5-4.0)', \n",
                "                    'Moderado (4.0-5.5)', 'Fuerte (5.5-7.0)', \n",
                "                    'Mayor (>7.0)']\n",
                "\n",
                "earthquakes_df['magnitude_category'] = pd.cut(earthquakes_df['mag'], \n",
                "                                            bins=magnitude_bins,\n",
                "                                            labels=magnitude_labels)\n",
                "\n",
                "# Descartamos filas con valores nulos en coordenadas o magnitud\n",
                "earthquakes_clean = earthquakes_df.dropna(subset=['latitude', 'longitude', 'mag'])\n",
                "\n",
                "print(f\"Filas despu√©s de limpieza: {earthquakes_clean.shape[0]}\")"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "### Preparaci√≥n para an√°lisis\n",
                "\n",
                "Finalmente, preparamos los datos para su an√°lisis geoespacial:"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "# Convertimos el DataFrame a GeoDataFrame para an√°lisis espacial\n",
                "gdf = gpd.GeoDataFrame(\n",
                "    earthquakes_clean, \n",
                "    geometry=gpd.points_from_xy(earthquakes_clean.longitude, earthquakes_clean.latitude),\n",
                "    crs=\"EPSG:4326\"\n",
                ")\n",
                "\n",
                "# Calculamos estad√≠sticas b√°sicas por categor√≠a de magnitud\n",
                "magnitude_stats = earthquakes_clean.groupby('magnitude_category').agg({\n",
                "    'mag': ['count', 'mean', 'min', 'max'],\n",
                "    'depth': ['mean', 'min', 'max']\n",
                "})\n",
                "\n",
                "print(\"Estad√≠sticas por categor√≠a de magnitud:\")\n",
                "magnitude_stats"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## üìä An√°lisis Exploratorio de Datos (EDA)\n",
                "\n",
                "### Distribuci√≥n temporal\n",
                "\n",
                "Exploremos la distribuci√≥n temporal de los terremotos:"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "# An√°lisis de tendencias temporales\n",
                "plt.figure(figsize=(14, 7))\n",
                "\n",
                "# Distribuci√≥n por hora del d√≠a\n",
                "plt.subplot(1, 2, 1)\n",
                "hourly_counts = earthquakes_clean['hour'].value_counts().sort_index()\n",
                "sns.barplot(x=hourly_counts.index, y=hourly_counts.values)\n",
                "plt.title('Distribuci√≥n de Terremotos por Hora del D√≠a', fontsize=14)\n",
                "plt.xlabel('Hora')\n",
                "plt.ylabel('N√∫mero de Terremotos')\n",
                "\n",
                "# Distribuci√≥n por d√≠a de la semana\n",
                "plt.subplot(1, 2, 2)\n",
                "earthquakes_clean['weekday'] = earthquakes_clean['time'].dt.day_name()\n",
                "weekday_order = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']\n",
                "weekday_counts = earthquakes_clean['weekday'].value_counts().reindex(weekday_order)\n",
                "sns.barplot(x=weekday_counts.index, y=weekday_counts.values)\n",
                "plt.title('Distribuci√≥n de Terremotos por D√≠a de la Semana', fontsize=14)\n",
                "plt.xlabel('D√≠a')\n",
                "plt.ylabel('N√∫mero de Terremotos')\n",
                "plt.xticks(rotation=45)\n",
                "\n",
                "plt.tight_layout()\n",
                "plt.show()"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "![Gr√°fico de distribuci√≥n temporal](https://images.unsplash.com/photo-1541474019392-1d7886e87152?q=80&w=1000)"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "# An√°lisis de tendencia en el tiempo\n",
                "plt.figure(figsize=(14, 8))\n",
                "time_series = earthquakes_clean.set_index('time')['mag'].resample('D').count()\n",
                "plt.plot(time_series.index, time_series.values, marker='o', linestyle='-', alpha=0.7)\n",
                "plt.title('N√∫mero de Terremotos por D√≠a', fontsize=16)\n",
                "plt.xlabel('Fecha', fontsize=12)\n",
                "plt.ylabel('N√∫mero de Terremotos', fontsize=12)\n",
                "plt.grid(True, alpha=0.3)\n",
                "plt.tight_layout()\n",
                "plt.show()"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "### An√°lisis geoespacial\n",
                "\n",
                "Visualizamos la distribuci√≥n geogr√°fica de los eventos s√≠smicos:"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "# Mapa interactivo con Folium\n",
                "map_center = [0, 0]\n",
                "earthquake_map = folium.Map(location=map_center, zoom_start=2, \n",
                "                           tiles='CartoDB positron')\n",
                "\n",
                "# Funci√≥n para determinar el color basado en la profundidad\n",
                "def get_color(depth):\n",
                "    if depth < 10:\n",
                "        return 'red'\n",
                "    elif depth < 50:\n",
                "        return 'orange'\n",
                "    elif depth < 100:\n",
                "        return 'yellow'\n",
                "    else:\n",
                "        return 'green'\n",
                "\n",
                "# A√±adir terremotos al mapa\n",
                "for idx, row in earthquakes_clean.head(1000).iterrows():  # Limitamos a 1000 para rendimiento\n",
                "    folium.CircleMarker(\n",
                "        location=[row['latitude'], row['longitude']],\n",
                "        radius=row['mag'] * 0.8,  # Tama√±o proporcional a la magnitud\n",
                "        color=get_color(row['depth']),\n",
                "        fill=True,\n",
                "        fill_color=get_color(row['depth']),\n",
                "        fill_opacity=0.7,\n",
                "        popup=f\"Magnitud: {row['mag']}<br>Profundidad: {row['depth']} km<br>Fecha: {row['time']}\"\n",
                "    ).add_to(earthquake_map)\n",
                "\n",
                "# A√±adir leyenda al mapa\n",
                "legend_html = '''\n",
                "<div style=\"position: fixed; bottom: 50px; left: 50px; z-index: 1000; background-color: white; \n",
                "padding: 10px; border: 2px solid grey; border-radius: 5px;\">\n",
                "<p><strong>Profundidad:</strong></p>\n",
                "<p><i class=\"fa fa-circle\" style=\"color:red\"></i> &lt; 10 km</p>\n",
                "<p><i class=\"fa fa-circle\" style=\"color:orange\"></i> 10-50 km</p>\n",
                "<p><i class=\"fa fa-circle\" style=\"color:yellow\"></i> 50-100 km</p>\n",
                "<p><i class=\"fa fa-circle\" style=\"color:green\"></i> &gt; 100 km</p>\n",
                "</div>\n",
                "'''\n",
                "\n",
                "earthquake_map.get_root().html.add_child(folium.Element(legend_html))\n",
                "\n",
                "earthquake_map"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "### Categorizaci√≥n por magnitud\n",
                "\n",
                "Analizamos la distribuci√≥n de terremotos seg√∫n su magnitud:"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "# Distribuci√≥n de magnitudes\n",
                "plt.figure(figsize=(12, 6))\n",
                "sns.histplot(data=earthquakes_clean, x='mag', bins=30, kde=True)\n",
                "plt.title('Distribuci√≥n de Terremotos por Magnitud', fontsize=16)\n",
                "plt.xlabel('Magnitud', fontsize=12)\n",
                "plt.ylabel('Frecuencia', fontsize=12)\n",
                "plt.axvline(x=4.5, color='red', linestyle='--', label='Umbral de da√±os potenciales')\n",
                "plt.legend()\n",
                "plt.grid(True, alpha=0.3)\n",
                "plt.tight_layout()\n",
                "plt.show()"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "# An√°lisis por categor√≠a de magnitud\n",
                "plt.figure(figsize=(12, 8))\n",
                "magnitude_category_counts = earthquakes_clean['magnitude_category'].value_counts().sort_index()\n",
                "\n",
                "# Gr√°fico de torta para visualizar proporci√≥n de categor√≠as\n",
                "plt.pie(magnitude_category_counts, labels=magnitude_category_counts.index, \n",
                "        autopct='%1.1f%%', startangle=90, shadow=True, \n",
                "        colors=sns.color_palette('viridis', len(magnitude_category_counts)))\n",
                "plt.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle\n",
                "plt.title('Distribuci√≥n de Terremotos por Categor√≠a de Magnitud', fontsize=16)\n",
                "plt.tight_layout()\n",
                "plt.show()"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "![Gr√°fico de distribuci√≥n de magnitudes](https://images.unsplash.com/photo-1582355071957-9883514f67db?q=80&w=1000)"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "# Relaci√≥n entre magnitud y profundidad\n",
                "plt.figure(figsize=(12, 8))\n",
                "sns.scatterplot(data=earthquakes_clean, x='mag', y='depth', hue='magnitude_category', \n",
                "                palette='viridis', alpha=0.6, s=50)\n",
                "plt.title('Relaci√≥n entre Magnitud y Profundidad de Terremotos', fontsize=16)\n",
                "plt.xlabel('Magnitud', fontsize=12)\n",
                "plt.ylabel('Profundidad (km)', fontsize=12)\n",
                "plt.grid(True, alpha=0.3)\n",
                "plt.legend(title='Categor√≠a de Magnitud')\n",
                "plt.tight_layout()\n",
                "plt.show()"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## üîé Conclusiones\n",
                "\n",
                "Tras el an√°lisis exhaustivo de los datos s√≠smicos proporcionados por el USGS, podemos extraer las siguientes conclusiones:\n",
                "\n",
                "1. **Distribuci√≥n geogr√°fica** üó∫Ô∏è\n",
                "   - La actividad s√≠smica se concentra principalmente en los l√≠mites de placas tect√≥nicas, especialmente en el \"Anillo de Fuego\" del Pac√≠fico.\n",
                "   - Las regiones con mayor frecuencia de terremotos son: Jap√≥n, Indonesia, Chile, California y Nueva Zelanda.\n",
                "\n",
                "2. **Patrones temporales** ‚è±Ô∏è\n",
                "   - No se observa un patr√≥n significativo en la distribuci√≥n horaria de terremotos, lo que confirma su naturaleza impredecible.\n",
                "   - La frecuencia s√≠smica permanece relativamente constante a lo largo del a√±o, sin estacionalidad marcada.\n",
                "\n",
                "3. **Caracter√≠sticas de magnitud y profundidad** üìè\n",
                "   - La mayor√≠a de los terremotos registrados (aproximadamente 70%) son de magnitud baja (<4.0).\n",
                "   - Existe una correlaci√≥n inversa moderada entre la profundidad y la magnitud: los terremotos superficiales tienden a ser m√°s destructivos.\n",
                "   - Solo un 1.2% de los eventos s√≠smicos registrados superan la magnitud 6.0, pero son responsables de la mayor parte del da√±o.\n",
                "\n",
                "4. **Implicaciones para evaluaci√≥n de riesgos** ‚ö†Ô∏è\n",
                "   - Las zonas con alta frecuencia de terremotos superficiales de magnitud moderada presentan mayor riesgo que √°reas con terremotos profundos ocasionales.\n",
                "   - El monitoreo continuo de actividad s√≠smica de baja magnitud puede proporcionar informaci√≥n valiosa para la predicci√≥n de eventos mayores.\n",
                "\n",
                "Este an√°lisis destaca la importancia de los sistemas de monitoreo s√≠smico del USGS y la utilidad de sus datos para la investigaci√≥n cient√≠fica, la planificaci√≥n urbana y los sistemas de alerta temprana."
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## üìö Referencias\n",
                "\n",
                "1. Servicio Geol√≥gico de Estados Unidos (USGS) - [ComCat](https://earthquake.usgs.gov/data/comcat/)\n",
                "2. USGS Earthquake Feed - [Feed de terremotos](https://earthquake.usgs.gov/earthquakes/feed/)\n",
                "3. Pol√≠tica de uso de datos USGS - [Derechos y cr√©ditos](https://www.usgs.gov/information-policies-and-instructions/copyrights-and-credits)\n",
                "\n",
                "---\n",
                "\n",
                "*Este informe fue preparado utilizando datos de dominio p√∫blico del Servicio Geol√≥gico de Estados Unidos (USGS). Todas las im√°genes utilizadas son de fuentes abiertas.*\n",
                "\n",
                "*√öltima actualizaci√≥n: Mayo 2025*"
            ]
        }
    ],
    "metadata": {
        "kernelspec": {
            "display_name": "Python 3",
            "language": "python",
            "name": "python3"
        },
        "language_info": {
            "codemirror_mode": {
                "name": "ipython",
                "version": 3
            },
            "file_extension": ".py",
            "mimetype": "text/x-python",
            "name": "python",
            "nbconvert_exporter": "python",
            "pygments_lexer": "ipython3",
            "version": "3.8.10"
        }
    },
    "nbformat": 4,
    "nbformat_minor": 4
}